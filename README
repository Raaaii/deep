README 
This file describes the computer software implementation of DEEP Picker, which is the artificial neural network based 2D NMR spectral peak picking and deconvolution tool as described in the manuscript “Deep Neural Network for Accurate Deconvolution of Complex Multidimensional NMR Spectra” (Li et al. (2021), submitted for publication). 

INSTALLATION
DEEP Picker can be built using CMAKE on any platform with C++ (V11 or newer).

Web server version of DEEP Picker
As an alternative to the above software, we also provide a web server version at http://spin.ccic.osu.edu/index.php/deep_picker,  which draws a contour plot of the input spectrum with all picked peaks indicated in the spectrum. This allows the visual assessment of the performance of DEEP picker. Note: the web server also includes a peak fitting function in addition to peak picking, which uses the peaks picked by DEEP Picker as starting points for the fitting of final peak positions, peak shapes, and amplitudes. This web server, which is most convenient for the demonstration and applications of DEEP Picker, allows the users to download the picked and fitted peak lists and the reconstructed spectrum for further use in their NMR spectral analysis workflow.  

Spectral processing of input spectra
The following are the spectral processing steps that should be followed carefully as they are important for the performance of DEEP Picker.
1. The number of points per peak (PPP), which is the number of data points that sample the peak’s full width at half height (FWHH), is allowed to vary either from 6 to 20 points or from 4 to 12 points, whereby the former is typical for proteins and the latter for metabolomics spectra. The Lorentzian component can vary from 0%, corresponding to a pure Gaussian lineshape, to 100%, corresponding to a pure Lorentzian lineshape. Typically, 3-fold of zero-filling is required to reach these PPPs.
2. We strongly recommend to use the 2pi-Kaiser window function for apodization in the NMRPipe software with the command “SP -off 0.5 -end 0.896 -pow 3.684”. The resulting peak shapes can then be modeled in all dimensions with good accuracy by a Voigt profile that combines variable amounts of Lorentzian vs. Gaussian character.

Command line arguments
The program accepts the following command line arguments:
noise_level: the program uses 1.48 times the median absolute deviation of an empty (i.e. peak-free) region of the spectrum to automatically estimate the noise level. Users can also set the noise level directly using this command line argument. The default value is 0, which means that the program will estimate the noise level automatically. 
scale: minimal peak amplitude cutoff defined as a multiple of the noise level. The default value is 5.5. Peaks with amplitudes below this value will not be picked, but they are still shown in spectrum. 
scale2: noise floor cutoff defined as a multiple of noise level. Prior to peak picking, spectral points will be set to 0 if their amplitude is lower than this cutoff. Default value is 3.0. 
in: input file name. The program accepts nmrpipe (.ft2), sparky (.ucsf), Topspin ASCII format (.txt) or Mnova (.csv) formats. The program uses file extension to recognize the file format. Default is input.ft2.
out: filename of output peak list in NMRPipe format. The default filename is “peaks.tab”.  The program will also write a peak list in Sparky format with the same file name with file extension “.list”. Peak list files can be directly imported into the corresponding software to view the spectrum along with the picked peaks allowing the visual assessment of the performance of DEEP picker.   
model: ANN model selection according to typical PPP range of spectrum (see above). It is either 1 (6 < PPP < 20 (typically for protein spectra)) or 2 (4 < PPP < 12 (typically for metabolomics spectra)). Default is 1.

